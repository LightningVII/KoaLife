<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <link href="../../fonts/iconfont.css" rel="stylesheet" />
    <link href="../../css/sm.css" rel="stylesheet" />
    <link href="../../css/app/common.css" rel="stylesheet" />
</head>

<body>
    <div class="page-group">
        <div class="page">
            <header class="bar bar-nav bg-263846" style="box-shadow: none;">
                <a class="pull-left iconfont icon-back color-white mui-action-back"></a>
                <a id="skipBtn" class="pull-right color-white" style="line-height: 2.2rem;">跳过</a>
                <h1 class="title">个人信息</h1>
            </header>
            <div class="content pr075 pl075" layout="column top-center">
                <div class="content-block p0 mb075 mt075">
                    <div class="card m0">
                        <div class="card-content">
                            <div class="list-block">
                                <ul class="w100p">
                                    <li class="item-content">
                                        <div class="item-inner">
                                            <span class="" style="width: 6rem;">真实姓名:</span>
                                            <div class="item-input">
                                                <input id='account' name='name' type="text" placeholder="请填写真实姓名">
                                            </div>
                                        </div>
                                    </li>
                                    <li class="item-content">
                                        <div class="item-inner">
                                            <span class="" style="width: 6rem;">车牌号:</span>
                                            <div class="item-input">
                                                <input id='phoneCode' name='truckPlateNumber' type="text" placeholder="请填写车牌号" class="">
                                            </div>
                                        </div>
                                    </li>
                                    <li class="item-content">
                                        <div class="item-inner">
                                            <span class="" style="width: 6rem;">身份证号:</span>
                                            <div class="item-input">
                                                <input id='phoneCode' name='IDCard' type="text" placeholder="请填写身份证号" class="">
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <a id='submitBtn' class="button bg-primary border-radius-8" style="box-shadow: 0 -6px 0 rgba(0,0,0,0.2) inset;">提交</a>
            </div>
        </div>
    </div>
    <script src="../../js/lodash.js"></script>
    <script src="../../js/mui.js"></script>
    <script src="../../js/sm.js"></script>
    <script src="../../js/app.js"></script>
    <script src="../../js/i18n.js"></script>
    <script>
        window.app.ready(function(mui) {
            $("input[name='name']").val("")
            $("input[name='IDCard']").val("")
            $("input[name='truckPlateNumber']").val("")
            var toHome = function() {
                if (!app.chromeDebug) {
                    var toPage = plus.webview.getWebviewById("home")
                    mui.fire(toPage, 'refreshFire', {});
                    mui.openWindow({
                        url: 'home.html',
                        id: plus.runtime.appid
                    });
                } else {
                    mui.openWindow({
                        url: 'home.html',
                        id: "home"
                    });
                }

            }

            $("#submitBtn").on("click", function() {
                app.mask();
                app.ajaxPost('/driver_info_edit', {
                    driverName: $("input[name='name']").val() || "",
                    IDCard: $("input[name='IDCard']").val() || "",
                    truckPlateNumber: $("input[name='truckPlateNumber']").val() || ""
                }, function(res) {
                    if (res.message == null) {
                        app.toast("提交成功！")
                        app.unmask();
                        app.setStoredItem('name', $("input[name='name']").val() || "")
                        if (!app.chromeDebug) {
                            mui.fire(plus.webview.getWebviewById("mine"), 'fireInit', {});
                            mui.fire(plus.webview.getWebviewById("settings"), 'fireInit', {});
                        }
                        mui.later(toHome, 2000)
                    } else {
                        app.toast(app.i18n[res.message.toUpperCase()]);
                    }
                })
            })

            $("#skipBtn").on("click", function() {
                toHome();
            })
        })
    </script>

</body>

</html>